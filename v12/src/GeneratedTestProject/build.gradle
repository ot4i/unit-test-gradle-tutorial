plugins {
    id 'java-library'
}
def baseFilePath = System.getenv("MQSI_BASE_FILEPATH")
def fileSep = System.getProperty("file.separator")

if (!baseFilePath)
{
    throw new GradleException('You must run mqsiprofile to configure your build environment first')
}

dependencies {
    implementation fileTree(dir: baseFilePath + fileSep + "common" + fileSep +"classes", include: "Integration*.jar")
    implementation fileTree(dir: baseFilePath + fileSep + "server" + fileSep +"classes", include: "junit*.jar")
}

sourceSets {
    main {
        java {
            srcDirs = ["src" + fileSep + "main" + fileSep + "java"]
        }
    }
}

processResources {
    exclude '**/*'
}

jar {
    from sourceSets.main.java
    destinationDirectory = file("$rootDir")
}

task copyRecordedMessages(type: Copy) {
    from "src" + fileSep + "main" + fileSep + "resources"
    into "resources"
}

jar.dependsOn copyRecordedMessages

defaultTasks 'jar'